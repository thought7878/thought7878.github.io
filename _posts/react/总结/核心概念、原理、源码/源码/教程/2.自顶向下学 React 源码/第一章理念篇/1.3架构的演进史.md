本视频讲述了React 15架构为何无法支持异步可中断更新，以及React 16如何通过新增调度器模块实现异步可中断更新的机制。

![[_posts/react/总结/核心概念、原理、源码/源码/教程/2.自顶向下学 React 源码/第一章理念篇/media/3e1aabfd12c88ca277151324c5e7ff1f_MD5.webp]]

### 老的React架构（React 15）的工作原理 
[00:23](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=23)

- **架构组成**
    - 协调器与渲染器 [00:37](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=37)  
        架构分为两部分：`协调器`负责决定哪些组件需要更新，`渲染器`负责将这些组件渲染到视图中。
    - `协调器`的作用 [00:46](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=46)  
        使用diff算法比较新旧组件树，仅更新发生变化的部分。
    - `渲染器`的功能 [01:14](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=74)  
        根据宿主环境不同，将组件渲染为对应平台的视图，如：
        - React DOM → 浏览器或 SSR
        - React Native → 原生组件
        - React Test → 纯 JS 对象
        - React VR → Canvas/SVG
- 同步更新流程示例 [01:50](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=110)
    - 组件包含按钮和三个列表项，点击按钮后 count 增加。
    - 列表项值为 1\*count, 2\*count, 3\*count。
    - 更新流程如下：
        - 协调器发现第一个列表项需更新为2，通知渲染器更新DOM [02:46](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=166)
        - 接着第二个列表项更新为4 [03:00](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=180)
        - 最后第三个列表项更新为6 [03:00](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=180)
    - 所有更新同步执行，用户看到的是最终整体变化 [03:32](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=212)
- 同步更新的问题 [03:44](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=224)
    - 如果更新变为异步可中断，会出现中间状态被展示，例如从1→2时，其他项未更新，导致显示223，这是不可接受的错误 [04:06](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=246)
    - 因此，React 15 的架构无法支持异步可中断更新 [04:47](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=287)

![[_posts/react/总结/核心概念、原理、源码/源码/教程/2.自顶向下学 React 源码/第一章理念篇/media/d7fa77c000c3782136e7e44519803215_MD5.webp]]

![[_posts/react/总结/核心概念、原理、源码/源码/教程/2.自顶向下学 React 源码/第一章理念篇/media/f47726edefb1505511d193204c6736f2_MD5.webp]]

### React 16 新架构的设计改进 
[04:52](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=292)

- 新增调度器模块
    - 调度器（Scheduler）的作用 [05:01](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=301)  
        负责管理异步更新任务，并赋予每个更新优先级。
        - 高优先级更新优先执行 [05:09](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=309)
- 新架构工作流程 [05:19](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=319)
    - 更新首先由调度器处理，决定其优先级 [05:23](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=323)
    - 协调器在内存中进行diff操作，不会直接修改视图 [05:49](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=349)
    - 若有更高优先级更新插入，当前协调过程可被中断 [05:38](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=338)
    - 完成协调后，协调器通知渲染器执行实际的视图更新 [06:03](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=363)
    - 渲染器完成更新后，调度器继续调度下一批任务 [06:29](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=389)
    - ![[_posts/react/总结/核心概念、原理、源码/源码/教程/2.自顶向下学 React 源码/第一章理念篇/media/142b616f5951bfc3aca6056891ab8e33_MD5.webp]]
- 具体更新流程示例 [06:36](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=396)
    - 点击按钮触发更新，state从1变为2 [06:43](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=403)
    - 调度器接收更新并判断是否有更高优先级任务 [06:51](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=411)
    - 没有高优任务则交给协调器进行diff计算 [06:57](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=417)
    - 协调器生成新的虚拟DOM，并标记需要更新的节点 [07:09](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=429)
    - 渲染器根据标记执行真实DOM更新操作 [07:42](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=462)
    - 整个流程协作完成一次异步可中断的更新 [07:55](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=475)

![[_posts/react/总结/核心概念、原理、源码/源码/教程/2.自顶向下学 React 源码/第一章理念篇/media/a947cf4d64a78dbea706f200f8c04309_MD5.webp]]

### 总结与过渡 
[08:07](https://b.quark.cn/apps/5AZ7aRopS/routes/quark-video-ai-summary/pc?debug=0&fid=24a5c265c54f495bba51ddb53eeec646#?seek_t=487)

- React 15 的局限性  
    同步更新机制无法满足快速响应需求，容易因长任务阻塞主线程。
- React 16 的关键改进  
    引入调度器模块，使更新具备优先级和中断恢复能力。
- 后续内容预告  
    下一节将进一步讲解React 16协调器内部如何实现异步可中断更新。