# 1.1 为什么需要软件架构 
## 1.1.1 什么是软件架构

## 1.1.2 开发人员需要怎样的软件架构
### 第一个重点便是因地制宜
- 小公司无法照搬BAT级公司的架构：大公司拥有大量的资源、基础设施、优秀人才
- 小公司若想实现大公司的架构：时间上的长时间投入，或者有强力的技术人员

### 软件架构需要的人才：高质量（有质量）地完成系统的设计

### 软件架构应包含以下内容：
#### 系统间关系：该系统与其他系统之间的关系（调用关系、依赖关系等）
#### 系统内关系：系统内各子系统之间的关系（如前端应用与后端应用，以怎样的方式通信，需要怎样的通信机制）

#### 应用内架构：应用内部的框架、组件，并清楚地表示出它们之间的关系

#### 规范和原则：指导项目中的开发人员，编写出符合需求的代码，以构建出设计中的架构

#### 瀑布型项目（包含类级别的架构，即一个类应该提供怎样的接口，存在怎样的继承关系）

#### 敏捷型项目（）

# 1.2 架构的设计
## 架构设计（并非只是技术工作，包含了一系列复杂的工作），其范围包括：
### 软件工程
### 开发实践
### 业务交付

## 架构设计的步骤： 
### （1）收集利益相关者的需求
- 用户的需求
- 产品经理（业务人员）、项目经理（项目负责人）等相关者的需求

### （2）与相应的技术人员（如开发人员、测试人员）讨论，了解架构上的潜在限制 
 
### （3）寻找潜在的可行性技术方案 
### （4）整理出功能列表中的功能性需求和跨功能性需求 
###  （5）找出会严重影响开发的风险点 
### （6）和技术委员会、利益相关者反复确认方案（可选）
### （7）对架构设计进行概念证明 
### （8）细化架构的部分实施细节 
### （9）结合技术和业务，进行需求排期
### 对于不同项目来说，上述步骤都会有所不同（有的可以直接忽略一些步骤，有的则会包含更多的步骤）
### 在这个过程中，最重要的是收集需求
- 有了需求之后，才能进行相关的技术决策
- 每个项目的需求不同，技术方案也略有差异

## 1.2.1 收集架构需求（需求分析）
### 如何明确架构需要解决的问题？
#### 了解相关者的利益
##### 互联网软件的生命周期中的角色有哪些？每种角色的目标、任务、责任是什么？参考：[[软件生命周期中的角色]]
##### 各方的利益诉求不一致，需某一方做出一定的妥协

#### 寻找架构关注点
##### 架构设计中的关注点：
###### 性能：需达到怎样的性能指标、实现多少用户的并发
###### 安全：如何保障用户数据安全、如何应对客户端服务端的攻击
###### 用户体验：用户体验是否比其他几个维度更重要
###### 平台化：应用是否需作为一个承载其他系统的平台 
###### 代码维护：是否稍有经验的开发人员都能快速上手 

##### 不同项目不同需求，关注点的优先级不一样
##### 决策时和相关者讨论，得到关注点的优先级顺序（**优先级，对于后续工作非常有帮助，可减少设计上出现的返工**）

#### 明确跨功能需求
按功能性来划分
##### 功能性需求：一个软件系统或组件的功能，也是一个系统需提供的功能及服务

##### 非功能性需求（跨功能性需求）：也是需求的重要组成部分，依靠一些条件，判断系统运作的情形或其特性，而不是针对系统特定行为的需求
###### 运行质量（Execution Qualities）：系统运行时观察到的质量，例如安全性、易用性等

###### 演进质量（Evolution Qualities）：它们体现在系统的静态结构中，例如软件*可测试性、可维护性、可扩展性、可伸缩性*等
###### 可用性：指在一段时间内，系统能够正常运行的概率。如何保证这样的可用性？
###### 容错性：系统中可能会出现哪些故障？如何确保这些故障不会让系统无法运行？ 

###### 可变性：在未来，应用的哪些地方会发生变化？是否需要提前做好准备？ 
###### 可维护性：指标是，在接到修改后，可以在相应的时间内（如小功能1～3天）修改完成

###### 可伸缩性：当更大规模的用户使用系统时，哪些服务会出现问题？ 
多数时候，对于后端服务来说，它们只会间接影响架构的决策。但是对于*前端应用*来说，它们往往会影响应用的架构——部分相关的内容是一些**兼容性、跨平台**相关的需求，举例如下。 

- 浏览器的支持范围：明确指出要针对哪些浏览器，以及浏览器的哪些版本做兼容。 
- 移动端设备支持的版本：常见的设备如Android和iOS，设备最低的支持版本，以及支持哪些设备制造商。 
- 它会严重影响前端系统的架构
 
###### 部分跨功能性需求可能是由产品经理提出来的，对这些问题**不是非常了解**
- 要坚持**以数据来说服人**：
	- 要么提供不同浏览器、系统的占比
	- 要么提供支持向下兼容的成本估算（真实的估算）

###### 在设计架构过程中，需详细列出实现跨功能需求的计划

#### 罗列技术风险点
##### 设计架构过程中，需寻找系统中的一系列技术风险点，并努力降低它们带来的风险
##### 为什么？**风险最影响应用开发**，不确定性带来的风险是**未知的**
##### 常见的风险类型：
###### **技术风险**：如果在应用中某一个功能的*实现比较复杂*，或者团队*缺乏某一领域的经验*，如AI，那么在实践的时候可能会影响系统的架构
###### **第三方系统集成**：在大中型公司内部，这是一个令人头痛的问题。如果集成后端服务，那么只需要确认对方的API能否按时上线，并按照我们的规范编写即可。如果*集成客户端的SDK或者组件*，那么第三方要以Web或原生代码的形式集成到系统中。不论哪种方式，都需要**提前进行技术方面的评审**，并在上线前安排联调。
###### **受限制的线上运行环境**：在开发人员和运维人员部门**分离**的组织里，往往会在内部限制某些语言，如选定Java等语言，限制其他语言的使用。如果选定的是其他语言，如JavaScript+Node.js，那么运维人员便难以维护，需要进行培训或者招聘新的运维人员
###### **需求带来额外的技术膨胀，不能按时完成开发带来风险**：比如，想要实现一个*复杂的前端动画效果*，经过评估可能需要两星期的开发时间，如果实现这个动画效果将*无法按时上线*。这时，要么努力去说服业务人员修改需求——适当地降低交互效果，要么将相应的功能排期靠后

## 1.2.2 架构模式
### 常见的架构风格有：
#### **分层风格**：最常见的架构风格，它将系统按照水平切分的方式分成多个层。一个系统由多层组成，每层由多个模块组成。每一层为上层提供服务，并使用下层提供的功能

#### **MVC架构风格**：将软件系统分为三部分：模型（Model）、视图（View）和控制器（Controller）。在涉及图形界面时，往往都有它的身影，如前端应用、移动端应用等

#### **发布-订阅风格**：基于事件的架构风格，是**一种一对多的关系**，一个对象状态改变时，所有订阅它的对象都会得到通知。**它的最大好处是代码上的解耦**，发布者不关心事件的订阅者，只在适当时发布相应的事件即可；而订阅者则依赖于事件。前端中，**为了解耦不同的UI组件的依赖**，经常采用

#### **管理和过滤器**：这是一种**适合于处理数据流**的架构模式，它将每个步骤都封装在一个过滤器组件中，数据通过相邻过滤器之间的管道传输。它**也适用于相关的数据处理场景**，如前端框架Angular，直接内置了管理（Pipe）系统

## 1.2.3 架构设计方法
### 架构的开发方法和开发流程，与架构开发的模式有关。由于这些设计方法往往是为了解决复杂的问题而存在的，**因而对于一般的项目来说，充满大量冗余的步骤，并不很实用**

### 简单地介绍4+1视图法、TOGAF。这两种方式，**侧重于从系统的角度来考虑问题，若只是从前端的角度来考虑，未免有些大材小用**

### 架构开发方法：4+1视图法

#### 系统架构图：
##### 包含了系统内的主要层级之间的关系、与第三方系统之间的关系
##### 包含了系统的软件架构部分、部署内容

#### 4+1视图法的构成：
##### **逻辑视图**（Logical View）：在设计期的**模块、接口**划分，职责及协作方式等。 
##### **流程视图**（Process View）：在运行期运行的数据同步，如在微前端中的**数据流、控制流**等。 
##### **开发视图**（Development View）：在开发期的**框架、库、技术选型、编译**。 
##### **部署视图/物理视图**（Physical View）：在部署期与持续交付相关的技术决策。 
##### **用例视图/场景**（Scenarios）：它使用一组用例或场景来说明架构
![](_posts/architect/_教程/前端架构：从入门到微前端/images/ch01/4+1.jpg)

#### 4+1视图法的设计流程：
##### （1）架构人员根据需求创建相应的逻辑架构，开发人员进行详细设计。 
##### （2）架构人员和开发人员根据需求设计物理架构，再由开发人员根据物理架构进行对应的详细设计

#### **这种烦琐的设计方式，既不适合于互联网应用，又不适合于前端应用**

#### **可作为借鉴，即从四个不同的维度（逻辑架构、开发流程、部署架构、运行时）来考虑软件技术的设计**

### 架构开发方法：TOGAF及ADM



## 1.2.4 生成架构产出物

# 1.3 架构设计原则
## 1.3.1 不多也不少
## 1.3.2 演进式
## 1.3.3 持续性 
# 1.4 前端架构发展史
# 1.5 前端架构设计：层次设计
## 1.5.1 系统内架构
## 1.5.2 应用级架构
## 1.5.3 模块级架构
## 1.5.4 代码级：规范与原则
# 1.6 小结
