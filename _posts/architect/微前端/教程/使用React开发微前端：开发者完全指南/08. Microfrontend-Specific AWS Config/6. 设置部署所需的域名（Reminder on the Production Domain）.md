

视频讲述了**设置营销部署所需的两项与生产域名相关的更改**，具体如下：


- **需处理production domain环境变量相关事宜**：[00:00]要在github仓库中**设置production_domain密钥**。**将Github的域名密钥，作为环境变量，暴露给webpack**，*确保有生产域名密钥且在webpack构建过程中可用，让容器应用知道获取营销远程入口文件的位置*，同时要注意marketing remoteEntry.js路径需添加/latest。
![[_posts/architect/微前端/教程/使用React开发微前端：开发者完全指南/08. Microfrontend-Specific AWS Config/media/d7665c05ee1809fbd2576f2456f0d073_MD5.jpeg]]

```yml
name: deploy-container

on:
  push:
    branches:
      - main
    paths:
      - 'packages/container/**'

defaults:
  run:
    working-directory: packages/container

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - run: npm install
      - run: npm run build
        env: # 将Github的域名密钥，作为环境变量，暴露给webpack。确保有生产域名密钥且在webpack构建过程中可用
          PRODUCTION_DOMAIN: ${{ secrets.PRODUCTION_DOMAIN }}

      - uses: shinyinc/action-aws-cli@v1.2
      - run: aws s3 sync dist s3://${{ secrets.AWS_S3_BUCKET_NAME }}/container/latest
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          AWS_DEFAULT_REGION: REPLACE_WITH_YOUR_REGION
      - run: aws cloudfront create-invalidation --distribution-id ${{ secrets.AWS_DISTRIBUTION_ID }} --paths "/container/latest/index.html"
        env:
          AWS_ACCESS_KEY_ID: ${{ secrets.AWS_ACCESS_KEY_ID }}
          AWS_SECRET_ACCESS_KEY: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          AWS_DEFAULT_REGION: REPLACE_WITH_YOUR_REGION

```

- **在营销配置webpack prod js文件中设置输出publicPath属性**：[04:18]*设置publicPath*为当前域名`/marketing/latest/`，使模块联邦插件创建的*远程入口文件能指向S3存储桶内的正确文件夹*，指导其他程序加载项目中的其他代码。
![[_posts/architect/微前端/教程/使用React开发微前端：开发者完全指南/08. Microfrontend-Specific AWS Config/media/a6364b87fe12325d5d21c62530068341_MD5.jpeg]]


- **最后需尝试部署应用程序**：[05:41]完成上述设置后，要实际部署应用程序。