### Webpack Module Federation æ·±åº¦è§£æï¼šå¾®å‰ç«¯çš„æ„å»ºå±‚é©å‘½

Webpack Module Federation (MF) æ˜¯ **Webpack 5 å†…ç½®çš„å¾®å‰ç«¯è§£å†³æ–¹æ¡ˆ**ï¼Œå®ƒ**ä»æ„å»ºå±‚é¢å®ç°æ¨¡å—çº§è”é‚¦**ï¼Œå½»åº•æ”¹å˜äº†ä¼ ç»Ÿå¾®å‰ç«¯çš„é›†æˆæ–¹å¼ã€‚ä¸ Qiankun ç­‰è¿è¡Œæ—¶æ–¹æ¡ˆä¸åŒï¼ŒMF é€šè¿‡**ç¼–è¯‘æ—¶ä¼˜åŒ–**è§£å†³äº†ä¾èµ–å…±äº«ã€ç‰ˆæœ¬ç®¡ç†ç­‰æ ¸å¿ƒç—›ç‚¹ã€‚æœ¬æ–‡å°†ä»**åŸç†åˆ°å®æˆ˜**ï¼Œå¸¦ä½ å½»åº•æŒæ¡è¿™ä¸€é¢ è¦†æ€§æŠ€æœ¯ï¼ˆé™„å¤§é‡å¯è¿è¡Œä»£ç ç¤ºä¾‹ï¼‰ã€‚

---

## ä¸€ã€ä¸ºä»€ä¹ˆ Module Federation æ˜¯å¾®å‰ç«¯çš„æœªæ¥ï¼Ÿ
### ä¼ ç»Ÿå¾®å‰ç«¯æ–¹æ¡ˆçš„è‡´å‘½ç¼ºé™·
| é—®é¢˜         | Qiankun ç­‰æ–¹æ¡ˆ              | Module Federation è§£å†³æ–¹æ¡ˆ |
| ---------- | ------------------------ | ---------------------- |
| **ä¾èµ–é‡å¤åŠ è½½** | å¤šä¸ªå­åº”ç”¨éƒ½å¼•å…¥ React â†’ é‡å¤æ‰“åŒ…    | **ç¼–è¯‘æ—¶è¯†åˆ«å…±äº«ä¾èµ–**ï¼ŒåªåŠ è½½ä¸€æ¬¡    |
| **ç‰ˆæœ¬å†²çª**   | React 16 å’Œ 18 æ··ç”¨ â†’ å…¼å®¹æ€§é—®é¢˜ | **è‡ªåŠ¨é™çº§/å‡çº§** å…±äº«æ¨¡å—ç‰ˆæœ¬     |
| **é€šä¿¡å¤æ‚åº¦**  | éœ€æ‰‹åŠ¨å®ç°äº‹ä»¶æ€»çº¿                | **ç›´æ¥ import è¿œç¨‹æ¨¡å—**     |
| **é¦–å±æ€§èƒ½**   | éœ€åŠ è½½å®Œæ•´å­åº”ç”¨                 | **æŒ‰éœ€åŠ è½½æ¨¡å—**ï¼ˆç»†ç²’åº¦ï¼‰        |
| **æŠ€æœ¯æ ˆé™åˆ¶**  | æ”¯æŒå¤šæ¡†æ¶ä½†éš”ç¦»æˆæœ¬é«˜              | **åŒæ„åº”ç”¨æ›´é«˜æ•ˆ**ï¼ˆæ¨èåŒæŠ€æœ¯æ ˆï¼‰    |

> ğŸ’¡ **æ ¸å¿ƒçªç ´**ï¼š  
> MF ä¸æ˜¯"è¿è¡Œæ—¶åŠ è½½å­åº”ç”¨"ï¼Œè€Œæ˜¯ **"ç¼–è¯‘æ—¶æ„å»ºæ¨¡å—è”é‚¦"**  
> â†’ ä¼ ç»Ÿæ–¹æ¡ˆï¼š`<script src="app1.js">` â†’ åŠ è½½æ•´ä¸ªåº”ç”¨  
> â†’ MF æ–¹æ¡ˆï¼š`import { Button } from 'app1/Button'` â†’ åªåŠ è½½éœ€è¦çš„æ¨¡å—

---

## äºŒã€Module Federation æ ¸å¿ƒæ¦‚å¿µå›¾è§£
### ä¸‰å¤§æ ¸å¿ƒè§’è‰²ï¼ˆå¿…æ‡‚ï¼ï¼‰
```mermaid
graph LR
  A[Host åº”ç”¨] -- æä¾›å…±äº«ä¾èµ– --> B[Shared Dependencies]
  C[Remote åº”ç”¨] -- æš´éœ²æ¨¡å— --> D[Module Federation]
  A -- æ¶ˆè´¹æ¨¡å— --> D
  D -- å…±äº«ä¾èµ– --> B
```

| è§’è‰²         | èŒè´£                                    | é…ç½®å…³é”®è¯              |
| ---------- | ------------------------------------- | ------------------ |
| **Host**   | å®¹å™¨åº”ç”¨ï¼ˆé€šå¸¸ä¸ºä¸»åº”ç”¨ï¼‰ï¼Œ**æ¶ˆè´¹** Remote æš´éœ²çš„æ¨¡å—      | `remotes: { ... }` |
| **Remote** | å­åº”ç”¨ï¼Œ**æš´éœ²**è‡ªèº«æ¨¡å—ä¾› Host æˆ–å…¶ä»– Remote ä½¿ç”¨    | `name`, `exposes`  |
| **Shared** | å…±äº«ä¾èµ–ï¼ˆå¦‚ Reactï¼‰ï¼Œç”± Host æä¾›ï¼ŒRemote è‡ªåŠ¨é™çº§ä½¿ç”¨ | `shared: { ... }`  |

### å…³é”®ç‰¹æ€§å¯¹æ¯”ï¼ˆMF vs ä¼ ç»Ÿæ–¹æ¡ˆï¼‰
| ç‰¹æ€§                | Module Federation                     | ä¼ ç»Ÿå¾®å‰ç«¯ï¼ˆå¦‚ Qiankunï¼‰        |
|---------------------|---------------------------------------|---------------------------------|
| **é›†æˆç²’åº¦**         | **æ¨¡å—çº§**ï¼ˆå¯ import å•ä¸ªç»„ä»¶ï¼‰      | åº”ç”¨çº§ï¼ˆåŠ è½½æ•´ä¸ªå­åº”ç”¨ï¼‰        |
| **ä¾èµ–ç®¡ç†**         | ç¼–è¯‘æ—¶è‡ªåŠ¨å¤„ç†ç‰ˆæœ¬å†²çª                | è¿è¡Œæ—¶æ‰‹åŠ¨å¤„ç†                  |
| **åŠ è½½æœºåˆ¶**         | é€šè¿‡ `import()` åŠ¨æ€åŠ è½½              | é€šè¿‡ `<script>` åŠ è½½            |
| **æŠ€æœ¯æ ˆçµæ´»æ€§**     | åŒæ„åº”ç”¨æœ€ä½³ï¼ˆReact/Reactï¼‰           | æ”¯æŒå¤šæ¡†æ¶ï¼ˆReact/Vue/Angularï¼‰ |
| **è°ƒè¯•ä½“éªŒ**         | åƒæœ¬åœ°æ¨¡å—ä¸€æ ·è°ƒè¯•                    | éœ€è·¨åº”ç”¨è°ƒè¯•                    |

> âœ… **MF æœ€ä½³é€‚ç”¨åœºæ™¯**ï¼š  
> - åŒæŠ€æœ¯æ ˆçš„å¤§å‹ç³»ç»Ÿï¼ˆå¦‚å…¨ React ä¼ä¸šåº”ç”¨ï¼‰  
> - å¯¹æ€§èƒ½è¦æ±‚æé«˜ï¼ˆéœ€ç»†ç²’åº¦åŠ è½½ï¼‰  
> - å›¢é˜Ÿç†Ÿæ‚‰ Webpack é…ç½®

---

## ä¸‰ã€æ ¸å¿ƒé…ç½®è¯¦è§£ï¼ˆé™„å®Œæ•´ä»£ç ç¤ºä¾‹ï¼‰
### åŸºç¡€é…ç½®ä¸‰è¦ç´ 
#### 1. Remote åº”ç”¨é…ç½®ï¼ˆå­åº”ç”¨ï¼‰
```javascript
// å­åº”ç”¨ webpack.config.js
const { ModuleFederationPlugin } = require('webpack').container;

module.exports = {
  plugins: [
    new ModuleFederationPlugin({
      name: 'productApp', // è¿œç¨‹åº”ç”¨å”¯ä¸€æ ‡è¯†
      filename: 'remoteEntry.js', // ç”Ÿæˆçš„å…¥å£æ–‡ä»¶
      exposes: {
        // æš´éœ²æ¨¡å—è·¯å¾„: å®é™…æ–‡ä»¶è·¯å¾„
        './ProductList': './src/components/ProductList',
        './utils': './src/utils/index'
      },
      shared: {
        // å£°æ˜å…±äº«ä¾èµ–ï¼ˆä¼šè‡ªåŠ¨å¤„ç†ç‰ˆæœ¬ï¼‰
        react: { singleton: true, eager: true, requiredVersion: '^18.2.0' },
        'react-dom': { singleton: true, eager: true }
      }
    })
  ]
};
```
> âš ï¸ **å…³é”®å‚æ•°è¯´æ˜**ï¼š
> - `singleton: true` â†’ å¼ºåˆ¶ä½¿ç”¨å•ä¾‹ï¼ˆé¿å…å¤šç‰ˆæœ¬ React å†²çªï¼‰
> - `eager: true` â†’ é¢„åŠ è½½å…±äº«ä¾èµ–ï¼ˆæå‡æ€§èƒ½ï¼‰
> - `requiredVersion` â†’ æŒ‡å®šå…¼å®¹ç‰ˆæœ¬èŒƒå›´

#### 2. Host åº”ç”¨é…ç½®ï¼ˆä¸»åº”ç”¨ï¼‰
```javascript
// ä¸»åº”ç”¨ webpack.config.js
module.exports = {
  plugins: [
    new ModuleFederationPlugin({
      name: 'mainApp',
      remotes: {
        // è¿œç¨‹åº”ç”¨å: "è¿œç¨‹åº”ç”¨åç§°@å…¥å£åœ°å€"
        productApp: 'productApp@http://localhost:3001/remoteEntry.js',
        userApp: 'userApp@http://localhost:3002/remoteEntry.js'
      },
      shared: {
        // å¿…é¡»ä¸ Remote ä¿æŒä¸€è‡´
        react: { singleton: true, eager: true },
        'react-dom': { singleton: true, eager: true }
      }
    })
  ]
};
```

#### 3. æ¨¡å—æ¶ˆè´¹æ–¹å¼ï¼ˆHost ä¸­ä½¿ç”¨ Remote æ¨¡å—ï¼‰
```jsx
// ä¸»åº”ç”¨ä¸­ç›´æ¥ import è¿œç¨‹æ¨¡å—
import ProductList from 'productApp/ProductList';
import { fetchUser } from 'userApp/utils';

function HomePage() {
  return (
    <div>
      <h1>ä¸»åº”ç”¨</h1>
      {/* ç›´æ¥ä½¿ç”¨è¿œç¨‹ç»„ä»¶ */}
      <ProductList />
      
      {/* è°ƒç”¨è¿œç¨‹å·¥å…·å‡½æ•° */}
      <button onClick={() => fetchUser(1)}>åŠ è½½ç”¨æˆ·</button>
    </div>
  );
}
```
> âœ¨ **é©å‘½æ€§ä½“éªŒ**ï¼š  
> å¯¹å¼€å‘è€…è€Œè¨€ï¼Œ**è¿œç¨‹æ¨¡å—å’Œæœ¬åœ°æ¨¡å—æ— ä»»ä½•åŒºåˆ«**ï¼  
> â†’ æ— éœ€ç‰¹æ®Š APIï¼Œç›´æ¥ `import` å³å¯ä½¿ç”¨

---

## å››ã€é«˜çº§ç‰¹æ€§ä¸å®æˆ˜æŠ€å·§
### è§£å†³ 90% ç”Ÿäº§é—®é¢˜çš„æ ¸å¿ƒæ–¹æ¡ˆ
#### 1. åŠ¨æ€åŠ è½½è¿œç¨‹æ¨¡å—ï¼ˆæŒ‰éœ€åŠ è½½ï¼‰
```jsx
// ä½¿ç”¨ React.lazy å®ç°ä»£ç åˆ†å‰²
const RemoteProductList = React.lazy(() => import('productApp/ProductList'));

function LazyPage() {
  return (
    <React.Suspense fallback={<Spinner />}>
      <RemoteProductList />
    </React.Suspense>
  );
}
```
> âœ… **æ€§èƒ½æå‡**ï¼š  
> - é¦–å±åªåŠ è½½å¿…è¦ä»£ç   
> - å­åº”ç”¨æ¨¡å—åœ¨éœ€è¦æ—¶æ‰åŠ è½½

#### 2. å¤šçº§è”é‚¦ï¼ˆRemote é—´äº’ç›¸è°ƒç”¨ï¼‰
```javascript
// Remote 1 é…ç½®
new ModuleFederationPlugin({
  name: 'cartApp',
  remotes: {
    // ä»å¦ä¸€ä¸ª Remote åŠ è½½
    productApp: 'productApp@http://localhost:3001/remoteEntry.js'
  },
  exposes: {
    './Cart': './src/Cart'
  }
});

// Remote 2 é…ç½®
new ModuleFederationPlugin({
  name: 'productApp',
  exposes: {
    './ProductList': './src/ProductList'
  }
});
```
> ğŸŒŸ **åœºæ™¯ä»·å€¼**ï¼š  
> è´­ç‰©è½¦åº”ç”¨ (cartApp) ç›´æ¥æ¶ˆè´¹å•†å“åˆ—è¡¨ (productApp)ï¼Œ**æ— éœ€ç»è¿‡ä¸»åº”ç”¨ä¸­è½¬**

#### 3. ä¾èµ–ç‰ˆæœ¬å†²çªè§£å†³æ–¹æ¡ˆ
```javascript
// ä¸»åº”ç”¨é…ç½®
shared: {
  react: {
    singleton: true,
    requiredVersion: '^18.2.0',
    // å½“ç‰ˆæœ¬ä¸åŒ¹é…æ—¶è‡ªåŠ¨é™çº§
    version: '18.2.0',
    // è‡ªå®šä¹‰ç‰ˆæœ¬å†²çªå¤„ç†
    override: (e) => {
      console.warn('React ç‰ˆæœ¬å†²çª', e);
      return e.local; // ä¼˜å…ˆä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬
    }
  }
}
```
> ğŸ’¡ **MF ç‰ˆæœ¬åå•†æœºåˆ¶**ï¼š  
> 1. Host å£°æ˜æœŸæœ›ç‰ˆæœ¬ `requiredVersion`  
> 2. Remote æä¾›å®é™…ç‰ˆæœ¬  
> 3. MF è‡ªåŠ¨é€‰æ‹©å…¼å®¹ç‰ˆæœ¬ï¼ˆé€šè¿‡ `override` å¯è‡ªå®šä¹‰ç­–ç•¥ï¼‰

#### 4. ç‹¬ç«‹å¼€å‘è°ƒè¯•æŠ€å·§
```javascript
// webpack.config.js
const remoteUrl = process.env.NODE_ENV === 'development'
  ? 'http://localhost:3001/remoteEntry.js'
  : 'https://cdn.example.com/remoteEntry.js';

new ModuleFederationPlugin({
  remotes: {
    productApp: `productApp@${remoteUrl}`
  }
});
```
> âœ… **å¼€å‘æµç¨‹**ï¼š  
> 1. å¯åŠ¨ Remote åº”ç”¨ï¼ˆ`npm run start`ï¼‰  
> 2. å¯åŠ¨ Host åº”ç”¨ â†’ è‡ªåŠ¨è¿æ¥æœ¬åœ° Remote  
> 3. ä¿®æ”¹ Remote ä»£ç  â†’ çƒ­æ›´æ–°ç”Ÿæ•ˆ

---

## äº”ã€é¿å‘æŒ‡å—ï¼šMF é«˜é¢‘é—®é¢˜è§£å†³æ–¹æ¡ˆ
### 10 å¤§ç”Ÿäº§ç¯å¢ƒé™·é˜±ï¼ˆé™„ä¿®å¤æ–¹æ¡ˆï¼‰
| é—®é¢˜ç°è±¡                  | æ ¹æœ¬åŸå›                | è§£å†³æ–¹æ¡ˆ                                                                   |
| --------------------- | ------------------ | ---------------------------------------------------------------------- |
| **Module not found**  | Remote æœªæ­£ç¡®æš´éœ²æ¨¡å—     | æ£€æŸ¥ `exposes` è·¯å¾„æ˜¯å¦åŒ¹é…æ–‡ä»¶å®é™…è·¯å¾„                                              |
| **React Hooks error** | å¤šä¸ª React å®ä¾‹        | ç¡®ä¿ `shared: { react: { singleton: true } }`                            |
| **æ ·å¼ä¸¢å¤±**              | CSS æœªé€šè¿‡ MF åŠ è½½      | 1. ç”¨ CSS-in-JS<br>2. æˆ–å•ç‹¬åŠ è½½ CSS æ–‡ä»¶                                      |
| **çƒ­æ›´æ–°å¤±æ•ˆ**             | Webpack HMR é…ç½®å†²çª   | ä¸»åº”ç”¨æ·»åŠ  `hot: true`ï¼š<br>`new ModuleFederationPlugin({ ..., hot: true })` |
| **IE11 å…¼å®¹é—®é¢˜**         | MF ä¾èµ– ES6+         | 1. æ·»åŠ  `@babel/preset-env`<br>2. é…ç½® `output.libraryTarget: 'umd'`       |
| **å…±äº«ä¾èµ–æœªç”Ÿæ•ˆ**           | `eager: false`ï¼ˆé»˜è®¤ï¼‰ | è®¾ä¸º `eager: true` ç¡®ä¿é¢„åŠ è½½                                                 |
| **å­åº”ç”¨æ— æ³•ç‹¬ç«‹è®¿é—®**         | æœªå¤„ç†å…¨å±€å˜é‡            | ```js if (!window.__POWERED_BY_QIANKUN__) { /* ç‹¬ç«‹è¿è¡Œé€»è¾‘ */ } ```         |
| **è·¯ç”±å†²çª**              | å­åº”ç”¨ä½¿ç”¨ History è·¯ç”±   | å­åº”ç”¨å¿…é¡»ç”¨ Hash è·¯ç”±ï¼š<br>`new BrowserRouter({ basename: '/product' })`       |
| **ç”Ÿäº§ç¯å¢ƒåŠ è½½è¶…æ—¶**          | CDN æœªé…ç½®ç¼“å­˜          | 1. è®¾ç½® `filename: 'remoteEntry.[contenthash].js'`<br>2. é…ç½® CDN ç¼“å­˜ç­–ç•¥     |
| **TypeScript ç±»å‹ä¸¢å¤±**   | æœªç”Ÿæˆç±»å‹å£°æ˜            | 1. ç”¨ `dts-plugin` ç”Ÿæˆç±»å‹<br>2. æˆ–æ‰‹åŠ¨å£°æ˜æ¨¡å—ï¼š`declare module 'productApp/*'`   |

### âš ï¸ é‡å¤§é™åˆ¶ï¼ˆå¿…é¡»çŸ¥é“ï¼ï¼‰
1. **ä»…æ”¯æŒ Webpack 5+**ï¼ˆCreate React App 5+ å·²å†…ç½®ï¼‰
2. **åŒæ„åº”ç”¨æ•ˆæœæœ€ä½³**ï¼ˆReact/React ç»„åˆæœ€æˆç†Ÿï¼‰
3. **ä¸æ”¯æŒ IE11**ï¼ˆéœ€å¤§é‡ polyfillï¼‰
4. **è°ƒè¯•è¾ƒå¤æ‚**ï¼šéœ€ç†è§£è”é‚¦æ¨¡å—çš„åŠ è½½é“¾è·¯

---

## å…­ã€MF vs Qiankun æ·±åº¦å¯¹æ¯”
### ğŸ†š ä½•æ—¶é€‰æ‹©å“ªç§æ–¹æ¡ˆï¼Ÿ
| åœºæ™¯                          | æ¨èæ–¹æ¡ˆ                     | åŸå›                                                                  |
|-------------------------------|------------------------------|----------------------------------------------------------------------|
| **å…¨ React/Vue æŠ€æœ¯æ ˆ**       | âœ… Module Federation          | æ— é¢å¤–æ¡†æ¶ï¼Œä¾èµ–å…±äº«æ›´å½»åº•ï¼Œæ€§èƒ½æ›´å¥½                                 |
| **å¤šæ¡†æ¶æ··åˆ**ï¼ˆReact+Vueï¼‰   | âœ… Qiankun                   | MF å¯¹å¼‚æ„æ”¯æŒå¼±ï¼ŒQiankun æ²™ç®±éš”ç¦»æ›´å¯é                               |
| **éœ€è¦ IE11 æ”¯æŒ**            | âœ… Qiankun                   | MF ä¾èµ– ES6+ï¼ŒQiankun å¯é€šè¿‡ LegacySandbox å…¼å®¹                      |
| **ç»†ç²’åº¦æ¨¡å—å…±äº«**            | âœ… Module Federation          | å¯ import å•ä¸ªç»„ä»¶ï¼ŒMF å¤©ç„¶æ”¯æŒ                                     |
| **å¿«é€Ÿè½åœ°ç®€å•åœºæ™¯**          | âœ… Module Federation          | é…ç½®æ›´ç®€å•ï¼ˆæ— éœ€ç”Ÿå‘½å‘¨æœŸé’©å­ï¼‰                                       |
| **å¤æ‚é€šä¿¡åœºæ™¯**              | âš–ï¸ æ··åˆæ–¹æ¡ˆ                  | MF åšæ¨¡å—å…±äº« + Qiankun åšåº”ç”¨çº§éš”ç¦»                                 |

> ğŸ’¡ **ç»ˆæå†³ç­–æ ‘**ï¼š  
> ```mermaid
> graph TD
>   A[æŠ€æœ¯æ ˆæ˜¯å¦ç»Ÿä¸€ï¼Ÿ] 
>   A -->|æ˜¯| B{æ€§èƒ½è¦æ±‚æé«˜ï¼Ÿ}
>   A -->|å¦| C[é€‰ Qiankun]
>   B -->|æ˜¯| D[é€‰ Module Federation]
>   B -->|å¦| E{éœ€è¦å¿«é€Ÿè½åœ°ï¼Ÿ}
>   E -->|æ˜¯| D
>   E -->|å¦| F[è¯„ä¼°æ··åˆæ–¹æ¡ˆ]
> ```

---

## ä¸ƒã€å®æˆ˜é¡¹ç›®ï¼šä»é›¶æ­å»º MF åº”ç”¨
### ğŸš€ ä¸‰æ­¥å®ç°ä¸»å­åº”ç”¨é€šä¿¡
#### æ­¥éª¤ 1ï¼šåˆ›å»º Remote åº”ç”¨ï¼ˆå•†å“æ¨¡å—ï¼‰
```bash
# åˆ›å»º React åº”ç”¨
npx create-react-app product-app --template redux
cd product-app

# ä¿®æ”¹ webpack é…ç½®ï¼ˆä½¿ç”¨ cracoï¼‰
npm install @craco/craco -D
```

```javascript
// craco.config.js
const ModuleFederationPlugin = require('webpack/lib/container/ModuleFederationPlugin');

module.exports = {
  webpack: {
    configure: (webpackConfig) => {
      webpackConfig.output.publicPath = 'http://localhost:3001/';
      
      webpackConfig.plugins.push(
        new ModuleFederationPlugin({
          name: 'productApp',
          filename: 'remoteEntry.js',
          exposes: {
            './ProductList': './src/features/products/ProductList',
            './ProductDetail': './src/features/products/ProductDetail'
          },
          shared: { 
            ...deps, 
            react: { singleton: true, eager: true }, 
            'react-dom': { singleton: true, eager: true } 
          }
        })
      );
      
      return webpackConfig;
    }
  }
};
```

#### æ­¥éª¤ 2ï¼šåˆ›å»º Host åº”ç”¨ï¼ˆä¸»åº”ç”¨ï¼‰
```bash
npx create-react-app main-app
cd main-app
npm install @craco/craco -D
```

```javascript
// craco.config.js
module.exports = {
  webpack: {
    configure: (webpackConfig) => {
      webpackConfig.output.publicPath = 'http://localhost:3000/';
      
      webpackConfig.plugins.push(
        new ModuleFederationPlugin({
          name: 'mainApp',
          remotes: {
            productApp: 'productApp@http://localhost:3001/remoteEntry.js'
          },
          shared: {
            react: { singleton: true, eager: true },
            'react-dom': { singleton: true, eager: true }
          }
        })
      );
      
      return webpackConfig;
    }
  }
};
```

#### æ­¥éª¤ 3ï¼šä¸»åº”ç”¨æ¶ˆè´¹è¿œç¨‹æ¨¡å—
```jsx
// main-app/src/App.js
import React, { Suspense } from 'react';

const ProductList = React.lazy(() => import('productApp/ProductList'));

function App() {
  return (
    <div className="App">
      <header className="App-header">
        <h1>ä¸»åº”ç”¨</h1>
        <Suspense fallback={<div>Loading products...</div>}>
          <ProductList />
        </Suspense>
      </header>
    </div>
  );
}
```

#### å¯åŠ¨å‘½ä»¤
```bash
# å¯åŠ¨å•†å“æ¨¡å—
cd product-app && npm start

# å¯åŠ¨ä¸»åº”ç”¨ï¼ˆè‡ªåŠ¨è¿æ¥æœ¬åœ°å•†å“æ¨¡å—ï¼‰
cd main-app && npm start
```

> âœ¨ **æ•ˆæœ**ï¼š  
> - ä¿®æ”¹ `product-app` ä»£ç  â†’ ä¸»åº”ç”¨è‡ªåŠ¨çƒ­æ›´æ–°  
> - æ‰“å¼€ Network é¢æ¿ â†’ åªåŠ è½½äº† `ProductList` æ¨¡å—ï¼ˆéæ•´ä¸ªåº”ç”¨ï¼‰

---

## å…«ã€å­¦ä¹ è·¯å¾„å»ºè®®ï¼ˆé«˜æ•ˆæŒæ¡ MFï¼‰
### ğŸ“š åˆ†é˜¶æ®µå®æˆ˜è®¡åˆ’
| é˜¶æ®µ         | ç›®æ ‡                          | å…·ä½“è¡ŒåŠ¨                                                                 |
|--------------|-------------------------------|--------------------------------------------------------------------------|
| **Day 1**    | è·‘é€šåŸºç¡€ demo                 | 1. ç”¨ [create-mf-app](https://github.com/module-federation/module-federation-examples) åˆ›å»ºä¸»å­åº”ç”¨<br>2. å®ç°æ¨¡å— import |
| **Day 2**    | æŒæ¡ä¾èµ–å…±äº«                  | 1. é…ç½® React å•ä¾‹å…±äº«<br>2. æ¨¡æ‹Ÿç‰ˆæœ¬å†²çªï¼ˆReact 17 vs 18ï¼‰éªŒè¯è§£å†³æ–¹æ¡ˆ |
| **Day 3**    | å®ç°å¤šçº§è”é‚¦                  | 1. è®© Remote A æ¶ˆè´¹ Remote B çš„æ¨¡å—<br>2. éªŒè¯ä¾èµ–ä¼ é€’ï¼ˆA â†’ B â†’ Reactï¼‰ |
| **Day 4-5**  | ç”Ÿäº§ç¯å¢ƒé›†æˆ                  | 1. é…ç½® CDN éƒ¨ç½²<br>2. æ·»åŠ  TypeScript ç±»å‹æ”¯æŒ<br>3. å®ç°é”™è¯¯è¾¹ç•Œå¤„ç† |
| **Week 2**   | å¤æ‚åœºæ™¯å®æˆ˜                  | 1. ä¸çŠ¶æ€ç®¡ç†é›†æˆï¼ˆRedux/Zustandï¼‰<br>2. å®ç°åŠ¨æ€è¿œç¨‹æ¨¡å—æ³¨å†Œ           |

### ğŸ”— å¿…çœ‹èµ„æºæ¸…å•
- **å®˜æ–¹æ–‡æ¡£**ï¼š  
  [Webpack Module Federation æŒ‡å—](https://webpack.js.org/concepts/module-federation/)ï¼ˆå¿…è¯»åŸºç¡€ï¼‰
- **å®æˆ˜ä»“åº“**ï¼š  
  - [å®˜æ–¹ç¤ºä¾‹åº“](https://github.com/module-federation/module-federation-examples)ï¼ˆå« React/Vue æ¡ˆä¾‹ï¼‰  
  - [Next.js + MF é›†æˆ](https://github.com/ScriptedAlchemy/NextFederationPlugin)
- **æ·±åº¦è§£æ**ï¼š  
  - [MF åŸç†å‰–æ](https://indepth.dev/posts/1184/webpack-5-module-federation-a-game-changer-in-javascript-architecture)  
  - [MF ä¸å¾®å‰ç«¯æ¼”è¿›](https://www.infoq.com/articles/micro-frontends-module-federation/)

---

## ä¹ã€é«˜çº§æŠ€å·§ï¼šè¶…è¶ŠåŸºç¡€ç”¨æ³•
### ğŸ”¥ ç”Ÿäº§çº§ä¼˜åŒ–æ–¹æ¡ˆ
#### 1. åŠ¨æ€è¿œç¨‹æ¨¡å—æ³¨å†Œï¼ˆæ— éœ€é‡å¯ï¼‰
```javascript
// ä¸»åº”ç”¨è¿è¡Œæ—¶æ·»åŠ  Remote
const addRemote = (name, url) => {
  const script = document.createElement('script');
  script.src = url;
  script.onload = () => {
    window.__webpack_init_sharing__('default');
    const container = window[name];
    container.init(__webpack_share_scopes__.default);
  };
  document.head.appendChild(script);
};

// ä½¿ç”¨ç¤ºä¾‹
addRemote('marketingApp', 'https://cdn.com/marketing/remoteEntry.js');
```

#### 2. ä¸çŠ¶æ€ç®¡ç†é›†æˆï¼ˆRedux ç¤ºä¾‹ï¼‰
```jsx
// Remote åº”ç”¨æš´éœ² store slice
export const productSlice = createSlice({ ... });

export const useProductStore = () => {
  const store = useStore();
  if (!store.product) {
    store.product = configureStore({ reducer: productSlice.reducer });
  }
  return store.product;
};
```

#### 3. æ€§èƒ½ç›‘æ§æ–¹æ¡ˆ
```javascript
// ä¸»åº”ç”¨æ·»åŠ åŠ è½½æ€§èƒ½ç›‘æ§
performance.mark('mf-start');
import('productApp/ProductList').then(() => {
  performance.mark('mf-end');
  const duration = performance.measure('mf-load', 'mf-start', 'mf-end');
  logToAnalytics('mf_load_time', duration.duration);
});
```

---

## æœ€åï¼šå…³é”®æ€»ç»“
### âœ… å¿…é¡»æŒæ¡çš„ 3 ä¸ªæ ¸å¿ƒ
1. **æ¨¡å—è”é‚¦æœ¬è´¨**ï¼š  
   â†’ ä¸æ˜¯åŠ è½½åº”ç”¨ï¼Œè€Œæ˜¯**æ„å»ºæ—¶åˆ›å»ºæ¨¡å—æ˜ å°„è¡¨**  
   â†’ `import('remote/app')` è¢«ç¼–è¯‘ä¸º `__webpack_require__.e("remote_app").then(() => ...)`

2. **ä¾èµ–å…±äº«æœºåˆ¶**ï¼š  
   â†’ é€šè¿‡ `shared` é…ç½®å»ºç«‹**ç‰ˆæœ¬åå•†è§„åˆ™**  
   â†’ Host æä¾›ä¾èµ– â†’ Remote è‡ªåŠ¨é™çº§ä½¿ç”¨

3. **å¼€å‘ä½“éªŒä¼˜åŠ¿**ï¼š  
   â†’ è¿œç¨‹æ¨¡å—**åƒæœ¬åœ°æ¨¡å—ä¸€æ ·è°ƒè¯•**  
   â†’ ä¿®æ”¹ Remote â†’ Host **è‡ªåŠ¨çƒ­æ›´æ–°**

### ğŸš« é¿å…å¤±è´¥çš„ 3 ä¸ªåŸåˆ™
1. **ä¸è¦è¿‡åº¦æ‹†åˆ†**ï¼š  
   â†’ æŒ‰**ä¸šåŠ¡åŸŸ**æ‹†åˆ†ï¼ˆå¦‚ `product`, `cart`ï¼‰ï¼Œè€ŒéæŒ‰æŠ€æœ¯æ‹†åˆ†
   
2. **ä¸¥æ ¼ç»Ÿä¸€å…±äº«ä¾èµ–**ï¼š  
   â†’ æ‰€æœ‰åº”ç”¨å¿…é¡»ä½¿ç”¨**å®Œå…¨ç›¸åŒçš„ React ç‰ˆæœ¬å£°æ˜**  
   â†’ `shared: { react: { singleton: true, requiredVersion: '^18.2.0' } }`

3. **ä¼˜å…ˆé€‰æ‹©åŒæ„æŠ€æœ¯æ ˆ**ï¼š  
   â†’ React + React ç»„åˆæœ€æˆç†Ÿ  
   â†’ é¿å…åœ¨ MF ä¸­æ··åˆ Vue/Reactï¼ˆç”¨ Qiankun å¤„ç†å¼‚æ„ï¼‰

> ğŸŒŸ **è¡ŒåŠ¨å»ºè®®**ï¼š  
> 1. ç«‹åˆ»ç”¨ `npx create-mf-app@latest` åˆ›å»º **React ä¸»åº”ç”¨ + 2 ä¸ª Remote**  
> 2. æ•…æ„åœ¨ Remote ä¸­ä½¿ç”¨ `React.useId()`ï¼ˆReact 18+ APIï¼‰ï¼ŒéªŒè¯ç‰ˆæœ¬é™çº§  
> 3. åœ¨ Network é¢æ¿ä¸­è§‚å¯Ÿ `remoteEntry.js` å’Œæ¨¡å—åŠ è½½é¡ºåº  

**é‡åˆ°é—®é¢˜ï¼Ÿ** è¯·æä¾›ï¼š  
- ä½ çš„ Webpack ç‰ˆæœ¬å’Œé…ç½®ç‰‡æ®µ  
- å…·ä½“é”™è¯¯ä¿¡æ¯ï¼ˆæˆªå›¾æ›´ä½³ï¼‰  
- ä½ æœŸæœ›çš„æ¨¡å—è°ƒç”¨æ–¹å¼  
æˆ‘å¯ä»¥å¸®ä½ ç²¾å‡†å®šä½ MF é…ç½®é—®é¢˜ï¼ ğŸ˜„