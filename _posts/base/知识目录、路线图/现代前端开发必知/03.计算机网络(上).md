【【现代前端开发必知03】计算机网络(上)】 https://www.bilibili.com/video/BV1dmvSe2EMo/?share_source=copy_web&vd_source=9c1e19a73fa7bd23bb37aa8d7467d862

DNS只是用于域名查询吗？
如何为网站绑定一个域名？
为什么首次打开网站比较慢？
CDN是如何利用DNS加速静态资源的？

## DNS
[00:15]

DNS（Domain Name System）域名系统

### 域名管理
#### A记录
`A记录`保存最终要返回的IP地址。在A记录上直接填写固定IP地址的方式，**只适用于简单的单机部署网站**。
#### CNAME记录
`CNAME记录`将子域名映射到另一个域名，可以指向相同域名也可以是其他主域名

![[_posts/base/知识目录、路线图/现代前端开发必知/media/ad53fa0d276a3dd27238eaa4a510db3c_MD5.jpeg]]

### 大型应用的域名管理
[01:40]
**在大型应用中，应用服务器分布式部署，IP地址是动态变化的。**
**因此，大型应用会采用`动态解析`IP地址的方式：** 将同一域名，根据不同网络运营商、不同地区，解析到不同IP地址的服务器上。

![[_posts/base/知识目录、路线图/现代前端开发必知/media/0109db4c62725067863102c737483b19_MD5.jpeg]]

在这真实世界中，这些服务器大概率*并非最终的应用服务器*，而是*具备反向代理能力的`负载均衡服务器`、`web应用防火墙`* 等等。而*真正的应用服务器IP地址是不会暴露于公网环境的*。

![[_posts/base/知识目录、路线图/现代前端开发必知/media/ced8d76c98190e3511d6886e70f8eeeb_MD5.jpeg]]

### 现代DNS的额外功能
现代DNS服务器除了具备基本的*域名解析*功能外，还会提供*安全插件DNS分析、利用边缘网络加速解析、ddos防护*这些功能。他们都是*为了更快更安全地为用户提供服务*。

![[_posts/base/知识目录、路线图/现代前端开发必知/media/1f3885ddc71622c0e4b6f1333fd86036_MD5.jpeg]]

## CDN与DNS
内容分发网络CDN与DNS有着密切关系。**当不同地区的用户访问前端静态资源时，会从不同的CDN节点下载数据**。
**这归功于DNS系统的CNAME记录**，DNS服务器会**根据用户所在地区返回不同的CNAME域名**，我们通常称之为`CDN加速域名`。
![[_posts/base/知识目录、路线图/现代前端开发必知/media/48b3ed47c69a4e13823b4223161ca643_MD5.jpeg]]

举一个*例子*，假设我们的图片资源托管在img.alicdn.com上，*如何知道用户实际上会访问到哪台CDN服务器呢？*
使用nslookup工具依次查询该域名的CNAME和A记录，最终我们会得到CDN服务器的IP地址，它的实际地理位置刚好就是用户所在地附近。

![[_posts/base/知识目录、路线图/现代前端开发必知/media/6f6d779a1b522310c7e4757d6e608f4a_MD5.jpeg]]
![[_posts/base/知识目录、路线图/现代前端开发必知/media/3493ad0be91ab7cca780d7305917828a_MD5.jpeg]]

## DNS的性能优化
通过前面的例子可以看到，在真实世界中，**DNS解析并非一轮完成，它背后会经历多次反复查询**。
**在没有任何缓存的情况下，它会非常慢**，以至于*显著影响到你的网站打开速度*。

因此无论是DNS云服务商还是互联网上的基础设施，都会**想尽办法加速DNS解析**。诸如**使用高性能的DNS服务器、配置DNS缓存、增加DNS记录的缓存时间（TTL）** 等等。

![[_posts/base/知识目录、路线图/现代前端开发必知/media/4a4cfe09f1cfba5c4d9a24f3d6d6d6f2_MD5.jpeg]]

![[_posts/base/知识目录、路线图/现代前端开发必知/media/acd04751628c63f281a0195f0c8fe419_MD5.jpeg]]

### 前端优化

作为前端，我们也可以通过浏览器提供的DNS预取功能来指定需要提前解析的域名。比如通过在HTML中添加DNS profit link标签，可以让浏览器在解析完该标签后立即进行DNS查询，来提升用户后续访问该域名的速度。利用DNS的查询原理，我们可以通过修改本地hosts的方式来给项目配置一个域名，而不是直接使用local host，这能有效解决与服务端联调时cookie无法跨域传输的问题。另外，如果项目依赖中硬编码了线上域名，通过修改本地DNS记录，可以在不改变代码的情况下，将线上域名映射到本地或者联调环境，方便问题验证和多环境联调。
