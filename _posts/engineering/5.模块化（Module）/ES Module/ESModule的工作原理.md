
【ESModule的工作原理【渡一教育】】 https://www.bilibili.com/video/BV1wt421H7op/?share_source=copy_web&vd_source=9c1e19a73fa7bd23bb37aa8d7467d862


视频讲述了浏览器原生机制下ESModule的工作原理，具体如下：
- **讨论范畴界定**：[00:00]明确讨论的是*浏览器原生机制下ESModule的加载方式*，不涉及webpack等构建工具及脚手架。
- **模块解析步骤**：[00:34]以页面加载的模块为入口点，将相对路径转为完整URL，*下载文件后解析内容，仅寻找顶层静态导入语句并提到代码最前，此过程不运行代码*，且静态导入语句不能进行字符串拼接，*随后对导入的模块重复此流程，直至所有所需模块文件准备完毕*。
- **模块执行步骤**：[02:33]从最初页面引入的模块开始，从上到下依次执行。执行导入语句时会先执行被导入模块，每个模块有对应的映射表，导出语句会往表中添加记录。导入的标识符与模块映射表中的默认导出共享内存空间，即符号绑定。已运行过的模块不会重新运行，会直接使用其映射表内容。
- **动态导入与静态导入的区别**：[05:23]*静态导入解析在运行前，动态导入解析在运行过程中*。动态导入会对目标JS重复模块解析和执行步骤，且此过程是异步的，原模块不会等待其下载完成，会继续执行后续代码。若动态导入的模块之前已解析下载，则不会重新解析。