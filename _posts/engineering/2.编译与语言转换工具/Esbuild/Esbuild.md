ä»¥ä¸‹æ˜¯å¯¹ **esbuild** çš„æ·±åº¦è§£æï¼Œèšç„¦å…¶**æ ¸å¿ƒå®šä½ã€æ€§èƒ½çœŸç›¸ã€æŠ€æœ¯è¾¹ç•Œ**åŠåœ¨ç°ä»£å‰ç«¯å·¥å…·é“¾ä¸­çš„**ç²¾å‡†ç”¨æ³•**ã€‚ä½œä¸ºè¿‘å¹´æ¥é¢ è¦†æ„å»ºé€Ÿåº¦è®¤çŸ¥çš„å·¥å…·ï¼Œesbuild å¸¸è¢«è¯¯è§£ä¸ºâ€œWebpack æ›¿ä»£å“â€ï¼Œä½†å®é™…å®ƒ**ä¸æ˜¯å®Œæ•´çš„æ¨¡å—æ‰“åŒ…å™¨ï¼ˆModule Bundlerï¼‰**ï¼Œè€Œæ˜¯ä¸€ä¸ª**æé€Ÿ JS/TS è½¬è¯‘å¼•æ“**ã€‚æˆ‘å°†é€šè¿‡ç¡¬æ ¸å¯¹æ¯”å’Œåœºæ™¯åŒ–å»ºè®®ï¼Œå¸®æ‚¨é¿å¼€è®¤çŸ¥é™·é˜±ã€‚

---

### **esbuild çš„æœ¬è´¨ï¼šä¸æ˜¯ Bundlerï¼Œè€Œæ˜¯â€œç¼–è¯‘åŠ é€Ÿå™¨â€**
| **ç»´åº¦**         | **esbuild**                              | **å®Œæ•´ Bundlerï¼ˆWebpack/Vite/Rollupï¼‰**   |
|------------------|------------------------------------------|-------------------------------------------|
| **æ ¸å¿ƒåŠŸèƒ½**     | **JS/TS è¯­æ³•è½¬è¯‘ + å‹ç¼©**ï¼ˆå•æ–‡ä»¶å¤„ç†ï¼‰  | æ¨¡å—ä¾èµ–åˆ†æã€èµ„æºæ‰“åŒ…ã€ä»£ç åˆ†å‰²ã€HMR ç­‰   |
| **ä¾èµ–å¤„ç†**     | âŒ æ— æ³•è§£æ `node_modules` ä¾èµ–å›¾         | âœ… æ·±åº¦è§£æ ESM/CommonJS ä¾èµ–              |
| **HMR æ”¯æŒ**     | âŒ åŸç”Ÿä¸æ”¯æŒ                             | âœ… Webpack/Vite æä¾›æ¯«ç§’çº§çƒ­æ›´æ–°           |
| **CSS/å›¾ç‰‡å¤„ç†** | âŒ ä»…æ”¯æŒ JS/TS/JSX                      | âœ… Webpack å¤„ç†æ‰€æœ‰èµ„æºï¼ŒVite æ”¯æŒåŸç”Ÿ CSS |
| **å…¸å‹è§’è‰²**     | **Bundler çš„åº•å±‚åŠ é€Ÿå¼•æ“**ï¼ˆå¦‚ Vite ç”¨å®ƒé¢„æ„å»ºä¾èµ–ï¼‰ | **å®Œæ•´æ„å»ºæµç¨‹çš„é©±åŠ¨è€…**                  |

> âœ… **å…³é”®ç»“è®º**ï¼š  
> **esbuild â‰  Webpack æ›¿ä»£å“**ï¼Œè€Œæ˜¯ **Bundler çš„â€œæ¶¡è½®å¢å‹å™¨â€**ã€‚  
> å®ƒè§£å†³ **â€œå•æ–‡ä»¶è½¬è¯‘é€Ÿåº¦â€** é—®é¢˜ï¼Œä½†**æ— æ³•ç‹¬ç«‹å®Œæˆåº”ç”¨æ‰“åŒ…**ï¼ˆç¼ºå°‘ä¾èµ–å›¾æ„å»ºã€èµ„æºå¤„ç†ç­‰æ ¸å¿ƒèƒ½åŠ›ï¼‰ã€‚

---

### **ä¸ºä»€ä¹ˆ esbuild é€Ÿåº¦å¦‚æ­¤ææ€–ï¼Ÿï¼ˆæ€§èƒ½çœŸç›¸ï¼‰**
#### 1. **Go è¯­è¨€ç¼–å†™ + å¤šçº¿ç¨‹å¹¶è¡Œ**
   - **ç¼–è¯‘é€Ÿåº¦**ï¼šæ¯” JS å·¥å…·ï¼ˆBabel/Webpackï¼‰**å¿« 10-100 å€**  
     ```bash
     # 10ä¸‡è¡Œ TypeScript ä»£ç è½¬è¯‘è€—æ—¶å¯¹æ¯”
     esbuild      : 0.4s  (Go å¤šçº¿ç¨‹)
     swc          : 2.1s  (Rust)
     Babel        : 22.1s (JavaScript)
     ```
   - **åŸç†**ï¼š  
     - Go è¯­è¨€ç›´æ¥ç¼–è¯‘ä¸ºæœºå™¨ç ï¼Œæ—  JS å¼•æ“å¼€é”€  
     - åˆ©ç”¨å¤šæ ¸ CPU å¹¶è¡Œè§£æ/ç”Ÿæˆä»£ç ï¼ˆBabel ä¸ºå•çº¿ç¨‹ï¼‰

#### 2. **æç®€è®¾è®¡å“²å­¦**
   | **åŠŸèƒ½**         | esbuild | Babel | é€Ÿåº¦ä¼˜åŠ¿æ¥æº               |
   |------------------|---------|-------|--------------------------|
   | è¯­æ³•è§£æ         | âœ…      | âœ…    | Go å®ç° AST æ›´å¿«          |
   | **ç±»å‹æ£€æŸ¥**     | âŒ      | âŒ    | esbuild è·³è¿‡ TS ç±»å‹æ£€æŸ¥  |
   | **Polyfill æ³¨å…¥**| âŒ      | âœ…    | esbuild æ—  polyfill èƒ½åŠ›  |
   | **æ’ä»¶ç³»ç»Ÿ**     | æç®€    | ä¸°å¯Œ  | æ’ä»¶é“¾å¤§å¹…é™ä½æ€§èƒ½æŸè€—    |

> âš ï¸ **é€Ÿåº¦ä»£ä»·**ï¼š  
> **esbuild ä¸ºé€Ÿåº¦ç‰ºç‰²äº†å…¼å®¹æ€§**ï¼š  
> - ä»…æ”¯æŒ **ES2020 è¯­æ³•**ï¼ˆä¸è½¬æ¢ `class static fields` ç­‰æ–°ç‰¹æ€§ï¼‰  
> - **ä¸å¤„ç† Polyfill**ï¼ˆæ—§æµè§ˆå™¨ç›´æ¥æŠ¥é”™ï¼‰  
> - **ä¸æ”¯æŒè‡ªå®šä¹‰æ’ä»¶**ï¼ˆæ— æ³•æ‰©å±•è¯­æ³•ï¼Œå¦‚ React Server Componentsï¼‰

---

### **esbuild åœ¨çœŸå®é¡¹ç›®ä¸­çš„è§’è‰²ï¼ˆæ­£ç¡®ç”¨æ³•ï¼‰**
#### âœ… **åœºæ™¯ 1ï¼šä½œä¸º Bundler çš„â€œåŠ é€Ÿå¼•æ“â€**ï¼ˆä¸»æµç”¨æ³•ï¼‰
| **Bundler** | **esbuild ä½œç”¨**                          | **é…ç½®ç¤ºä¾‹**                              |
|-------------|------------------------------------------|------------------------------------------|
| **Vite**    | å¼€å‘æ—¶ **é¢„æ„å»ºä¾èµ–**ï¼ˆ`node_modules`ï¼‰  | ```// vite.config.js<br>export default {<br>  optimizeDeps: {<br>    esbuildOptions: {<br>      define: { global: 'window' }<br>    }<br>  }<br>}``` |
| **Webpack** | é€šè¿‡ `esbuild-loader` **æ›¿ä»£ babel-loader** | ```module: {<br>  rules: [{<br>    test: /\.js$/,<br>    loader: 'esbuild-loader',<br>    options: { target: 'es2020' }<br>  }]<br>}``` |
| **Parcel**  | ç”Ÿäº§æ„å»º **JS å‹ç¼©**ï¼ˆæ›¿ä»£ Terserï¼‰      | ```{<br>  "minify": true,<br>  "sourceMaps": false<br>}``` |

> ğŸ’¡ **æ•ˆæœ**ï¼š  
> Webpack é¡¹ç›®ç”¨ `esbuild-loader` æ›¿æ¢ Babelï¼Œ**æ„å»ºé€Ÿåº¦æå‡ 3-5 å€**ï¼ˆå®æµ‹ 10k æ¨¡å—é¡¹ç›®ä» 30s â†’ 7sï¼‰ã€‚

#### âœ… **åœºæ™¯ 2ï¼šç‹¬ç«‹ç”¨äºç®€å•ä»»åŠ¡**
```bash
# 1. å¿«é€Ÿè½¬è¯‘ TS ä¸º JSï¼ˆæ— ç±»å‹æ£€æŸ¥ï¼‰
esbuild src/index.ts --bundle --outfile=dist/bundle.js --minify

# 2. å‹ç¼© JSï¼ˆæ¯” Terser å¿« 10 å€ï¼‰
esbuild input.js --minify --outfile=output.min.js

# 3. å¯åŠ¨ç®€æ˜“ HTTP æœåŠ¡å™¨ï¼ˆå¼€å‘é¢„è§ˆï¼‰
esbuild --servedir=dist --port=8000
```

#### âŒ **ç»å¯¹ä¸è¦ç”¨ esbuild çš„åœºæ™¯**
| **åœºæ™¯**                     | **åŸå› **                                                                 |
|------------------------------|--------------------------------------------------------------------------|
| éœ€è¦å…¼å®¹ **IE11/Safari 13-** | esbuild ä¸ç”Ÿæˆ polyfillï¼ˆ`Promise`/`Array.from` ç›´æ¥æŠ¥é”™ï¼‰               |
| ä½¿ç”¨ **å®éªŒæ€§è¯­æ³•**ï¼ˆDecoratorsï¼‰ | esbuild ä»…æ”¯æŒ Stage 4 è¯­æ³•ï¼ŒBabel æœ‰æ’ä»¶æ”¯æŒ                           |
| **åº“æ‰“åŒ…**ï¼ˆå‘å¸ƒ npm åŒ…ï¼‰    | æ— æ³•ç”Ÿæˆå¤šæ ¼å¼ï¼ˆUMD/CJS/ESMï¼‰äº§ç‰©ï¼ŒRollup æ‰æ˜¯ä¸“ä¸šé€‰æ‹©                   |

---

### **esbuild vs. ç«äº‰å¯¹æ‰‹ï¼šç¡¬æ ¸æ€§èƒ½å¯¹æ¯”**
#### 1. **å¼€å‘æ„å»ºé€Ÿåº¦ï¼ˆ10k è¡Œ TSX ä»£ç ï¼‰**
| **å·¥å…·**       | è½¬è¯‘é€Ÿåº¦ | å†…å­˜å ç”¨ | æ˜¯å¦æ”¯æŒ HMR | é€‚ç”¨åœºæ™¯               |
|----------------|----------|----------|--------------|----------------------|
| **esbuild**    | **0.4s** | 120MB    | âŒ           | ä¾èµ–é¢„æ„å»ºã€ç®€å•ä»»åŠ¡   |
| **swc**        | 1.3s     | 300MB    | âŒ           | ç”Ÿäº§æ„å»ºæ›¿ä»£ Babel     |
| **Babel**      | 22.1s    | 800MB    | âœ…ï¼ˆéœ€ Bundlerï¼‰| å…¼å®¹æ€§è¦æ±‚é«˜çš„ç”Ÿäº§æ„å»º |

#### 2. **ç”Ÿäº§æ„å»ºèƒ½åŠ›å¯¹æ¯”**
| **èƒ½åŠ›**               | esbuild | Rollup | Webpack |
|------------------------|---------|--------|---------|
| ä»£ç åˆ†å‰²               | âŒ      | âœ…     | âœ…      |
| Tree-shaking ç²¾åº¦      | â­â­     | â­â­â­â­  | â­â­â­    |
| CSS å¤„ç†               | âŒ      | éœ€æ’ä»¶  | âœ…      |
| **Polyfill æ™ºèƒ½æ³¨å…¥**  | âŒ      | âŒ     | âœ…ï¼ˆBabelï¼‰|

> ğŸ”¥ **æ®‹é…·çœŸç›¸**ï¼š  
> esbuild **æ— æ³•ç‹¬ç«‹å®Œæˆç”Ÿäº§æ„å»º**ï¼  
> - ç¼ºå°‘ä»£ç åˆ†å‰² â†’ æ— æ³•ç”Ÿæˆ `chunk-vendors.js`  
> - æ—  Tree-shaking â†’ åŒ…ä½“ç§¯æ¯” Rollup å¤§ **30%+**ï¼ˆå®æµ‹ Vue 3 é¡¹ç›®ï¼‰  
> - æ—  Polyfill â†’ æ—§æµè§ˆå™¨ç™½å±  

---

### **å¦‚ä½•æ­£ç¡®é›†æˆ esbuildï¼Ÿï¼ˆæœ€ä½³å®è·µï¼‰**
#### æ–¹æ¡ˆ 1ï¼šVite å¼€å‘ç¯å¢ƒï¼ˆæ¨èï¼‰
```js
// vite.config.js
export default {
  // å¼€å‘æ—¶ç”¨ esbuild é¢„æ„å»ºä¾èµ–ï¼ˆè§£å†³ node_modules æœªè½¬è¯‘é—®é¢˜ï¼‰
  optimizeDeps: {
    include: ['react', 'lodash-es'],
    esbuildOptions: {
      // ä¿®å¤æŸäº›åº“çš„ global æŒ‡å‘é—®é¢˜
      define: { global: 'window' },
      // å¼ºåˆ¶è½¬è¯‘ç‰¹å®šè¯­æ³•
      supported: { 'top-level-await': true }
    }
  },
  // ç”Ÿäº§æ„å»ºä»ç”¨ Rollupï¼ˆesbuild ä»…ä½œå‹ç¼©ï¼‰
  build: {
    minify: 'esbuild' // ç”¨ esbuild å‹ç¼©æ›¿ä»£ Terser
  }
}
```
> âœ… **ä¼˜åŠ¿**ï¼šå¼€å‘å¯åŠ¨é€Ÿåº¦ **< 100ms**ï¼Œç”Ÿäº§åŒ…ä½“ç§¯æœ€å°åŒ–ã€‚

#### æ–¹æ¡ˆ 2ï¼šWebpack ç”Ÿäº§æ„å»ºåŠ é€Ÿ
```js
// webpack.config.js
module.exports = {
  module: {
    rules: [
      // ç”¨ esbuild æ›¿ä»£ babel-loaderï¼ˆä»…é™ç°ä»£æµè§ˆå™¨é¡¹ç›®ï¼‰
      {
        test: /\.jsx?$/,
        loader: 'esbuild-loader',
        options: {
          target: 'es2020' // æŒ‡å®šç›®æ ‡æµè§ˆå™¨
        }
      }
    ]
  },
  optimization: {
    minimize: true,
    minimizer: [
      // ç”¨ esbuild å‹ç¼©æ›¿ä»£ Terser
      new ESBuildMinifyPlugin({ target: 'es2020' })
    ]
  }
}
```
> âš ï¸ **è­¦å‘Š**ï¼šä»…å½“ `.browserslistrc` é…ç½®ä¸º `> 0.5%, not dead` æ—¶å¯ç”¨ï¼ˆæ”¾å¼ƒ IE11ï¼‰ã€‚

---

### **esbuild çš„è‡´å‘½çŸ­æ¿ï¼ˆé¿å‘æŒ‡å—ï¼‰**
#### 1. **Polyfill ç¼ºå¤± = æ—§æµè§ˆå™¨ç¾éš¾**
   - **é—®é¢˜**ï¼šesbuild ä¸å¤„ç† `Promise`/`Array.from` ç­‰ API  
   - **åæœ**ï¼šSafari 13 ä»¥ä¸‹ã€å¾®ä¿¡å†…ç½®æµè§ˆå™¨ç›´æ¥æŠ¥é”™  
   - **è§£å†³æ–¹æ¡ˆ**ï¼š  
     ```js
     // åœ¨å…¥å£æ–‡ä»¶æ‰‹åŠ¨æ³¨å…¥ core-js
     import 'core-js/stable'; 
     import 'regenerator-runtime/runtime';
     ```

#### 2. **æ— æ³•æ”¯æŒå®éªŒæ€§è¯­æ³•**
   | **è¯­æ³•**               | esbuild | Babel | è§£å†³æ–¹æ¡ˆ                     |
   |------------------------|---------|-------|----------------------------|
   | `class { #private = 1 }` | âœ…     | âœ…    | æ— éœ€å¤„ç†                   |
   | `class { static { } }`   | âŒ     | âœ…    | ç”¨ Babel æ’ä»¶              |
   | React Server Components| âŒ     | âœ…    | å¿…é¡»ç”¨ Babel + è‡ªå®šä¹‰æ’ä»¶  |

#### 3. **èµ„æºå¤„ç†èƒ½åŠ›ä¸ºé›¶**
   - âŒ æ— æ³•å¤„ç† CSS/SVG/å­—ä½“  
   - âŒ æ— æ³•è§£æ `url('./image.png')`  
   - **æ›¿ä»£æ–¹æ¡ˆ**ï¼š  
     - ç”¨ Vite å¤„ç†èµ„æºï¼Œesbuild ä»…è´Ÿè´£ JS  
     - æˆ–é…åˆ `esbuild-plugin-cssmodules` ç­‰ç¬¬ä¸‰æ–¹æ’ä»¶ï¼ˆåŠŸèƒ½æœ‰é™ï¼‰

---

### **esbuild çš„æœªæ¥ï¼šåŠ é€Ÿå™¨è€Œéç»ˆç»“è€…**
#### âœ… æ­£ç¡®è¶‹åŠ¿
- **Bundler åº•å±‚å¼•æ“**ï¼šVite/Rollup/Parcel 2 å‡é›†æˆ esbuild ä½œä¸ºé»˜è®¤è½¬è¯‘å™¨  
- **ç”Ÿäº§æ„å»ºåŠ é€Ÿ**ï¼šWebpack 5+ ç”¨ `esbuild` æ›¿ä»£ Terser å‹ç¼© JS  
- **Rust æ¥åŠ›**ï¼š`Rspack`ï¼ˆWebpack å…¼å®¹ç‰ˆï¼‰ç”¨ Rust é‡å†™ï¼Œé€Ÿåº¦å†æå‡ 3 å€  

#### âŒ è¢«é«˜ä¼°çš„â€œå–ä»£è®ºâ€
> â€œesbuild å°†å–ä»£ Webpackâ€ â€”â€” **è¿™æ˜¯ä¼ªå‘½é¢˜**  
> - Webpack è§£å†³çš„æ˜¯ **â€œå¤æ‚åº”ç”¨äº¤ä»˜â€** é—®é¢˜ï¼ˆä¾èµ–å›¾ã€è¿è¡Œæ—¶ã€ä¼˜åŒ–ç­–ç•¥ï¼‰  
> - esbuild è§£å†³çš„æ˜¯ **â€œå•æ–‡ä»¶è½¬è¯‘â€** é—®é¢˜  
> **äºŒè€…æ ¹æœ¬ä¸åœ¨åŒä¸€ç»´åº¦ç«äº‰**

---

### **ç»ˆæé€‰å‹å»ºè®®**
| **é¡¹ç›®éœ€æ±‚**                     | **æ¨èæ–¹æ¡ˆ**                              | **ä¸ºä»€ä¹ˆ**                                |
|----------------------------------|------------------------------------------|------------------------------------------|
| **ç°ä»£æµè§ˆå™¨åº”ç”¨**ï¼ˆChrome/Firefoxï¼‰ | Vite + esbuildï¼ˆå¼€å‘/ç”Ÿäº§ï¼‰              | å¼€å‘å¯åŠ¨ < 100msï¼Œç”Ÿäº§åŒ…ä½“ç§¯æœ€ä¼˜         |
| **éœ€å…¼å®¹æ—§æµè§ˆå™¨**ï¼ˆSafari 13-ï¼‰ | Webpack + Babelï¼ˆç”Ÿäº§æ„å»ºï¼‰ + esbuildï¼ˆå¼€å‘ä¾èµ–é¢„æ„å»ºï¼‰ | Babel ä¿è¯ polyfill å®‰å…¨æ€§               |
| **æé€Ÿæ„å»ºçš„åº“**                 | Rollup + `@rollup/plugin-esbuild`        | ä¿ç•™ Rollup Tree-shakingï¼Œç”¨ esbuild åŠ é€Ÿ |
| **çº¯é™æ€é¡µé¢**ï¼ˆæ— æ¡†æ¶ï¼‰         | esbuild ç‹¬ç«‹è½¬è¯‘ + æ‰‹åŠ¨ Polyfill         | é¿å… Bundler é‡è½½ï¼Œæè‡´ç®€å•              |

> ğŸ’¡ **ä¸€å¥è¯æ€»ç»“**ï¼š  
> **â€œç”¨ esbuild åŠ é€Ÿè½¬è¯‘ï¼Œç”¨ Bundler å®Œæˆæ‰“åŒ…â€** â€”â€”  
> - **å¼€å‘é˜¶æ®µ**ï¼šesbuild å¤„ç†ä¾èµ–é¢„æ„å»ºï¼ˆViteï¼‰æˆ–æ›¿ä»£ babel-loaderï¼ˆWebpackï¼‰  
> - **ç”Ÿäº§é˜¶æ®µ**ï¼šRollup/Webpack è´Ÿè´£ä»£ç åˆ†å‰² + Tree-shakingï¼Œesbuild ä»…ä½œå‹ç¼©  
> **æ°¸è¿œä¸è¦ç”¨ esbuild ç‹¬ç«‹æ„å»ºç”Ÿäº§åº”ç”¨ï¼**ï¼ˆé™¤éä½ æ„¿æ„æ‰‹åŠ¨å¤„ç† 20 ä¸ªå…¼å®¹æ€§é—®é¢˜ï¼‰