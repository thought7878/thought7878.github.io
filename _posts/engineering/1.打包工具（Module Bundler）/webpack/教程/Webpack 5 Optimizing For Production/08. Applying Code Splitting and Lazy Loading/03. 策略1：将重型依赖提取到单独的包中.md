Strategy #1: Extracting Heavy Dependencies Into Separate Bundles

视频讲述了如何*使用 Webpack 将项目中较重的依赖（jquery 和 bootstrap）提取为单独的包*，以优化网站加载性能，具体如下：

## 问题

[00:00]
之前视频已设置 Webpack 捆绑分析器，发现**所有代码被打包到一个 JavaScript 文件**，*且存在 jquery（约 85KB）和 bootstrap（约 55KB）两个大型依赖*，**可拆分为单独包**。
同时指出*将所有代码与依赖打包在一个文件中，会导致浏览器加载时需下载所有代码和资源，耗时较长*，尤其在移动设备上，而*浏览器缓存可减少请求数量、加快加载速度*。

## Webpack 拆分依赖的核心工具

[01:12]
前往 Webpack 配置，*通过内置的 split chunks 插件实现依赖拆分*，无需额外安装，只需在 Webpack 配置的`优化部分 optimization`定义 `splitChunks 选项`。为将 jquery 和 bootstrap 分别打包，需定义两个缓存组，每个`缓存组 cacheGroups`需指定 `test 属性`（用正则表达式选择对应模块）和 `chunks 属性`（可选 initial、Async、all，此处先设为 initial，*仅选择初始加载的块*）。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/436fc3163672e2b14b21a6f5ab47d260_MD5.jpeg]]

## 执行拆分并发现包名问题

[03:40]
运行 Webpack 后，列表文件夹中出现新包，说明代码分割生效，但*新包名称奇怪，无法通过名称区分哪个包含 jquery、哪个包含 bootstrap*。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/62884403b0dfe21fd557fb89b8071e96_MD5.jpeg]]

## 解决包名识别问题

[04:23]
返回 IDE，**为每个缓存组指定名称 name**，再次运行 Webpack，生成的新包使用了清晰可辨的名称，可直接区分 jquery 包和 bootstrap 包。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/436fc3163672e2b14b21a6f5ab47d260_MD5.jpeg]]

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/89e627c07c723d60343c57044085c738_MD5.jpeg]]

## 验证拆分效果与总结

[05:10]
运行包分析器查看报告，**能看到 jquery 和 bootstrap 分别作为独立包存在**，还有包含其他内容的主包，**不同颜色代表不同包**，且左侧侧边栏可查看 Webpack 生成的三个包及各自大小（jquery 体积最大）。同时指出此为 Webpack 代码分割策略之一，后续视频会介绍更多策略。

