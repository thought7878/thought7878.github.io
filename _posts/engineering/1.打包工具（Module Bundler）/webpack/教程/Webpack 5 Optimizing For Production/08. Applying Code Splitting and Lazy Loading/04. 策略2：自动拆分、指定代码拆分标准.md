Strategy #2: Specifying Criteria For Code Splitting

视频讲述了*Webpack 代码分割的第二种策略——指定代码分割标准*的相关操作及原理，具体如下：

## 回顾前期代码分割方式

[00:00]
之前视频中，通过*正则表达式*明确告知 Webpack *提取 Jquery 和 bootstrap 这两个庞大库，将重型依赖项提取到单独包中*。

## Webpack **自动判断**提取功能

[00:21]
**Webpack 具备智能判断能力，无需明确指定提取库，只需告知其代码分割规则，就能*自行判断*需提取的库并生成最终包**。

## 代码分割规则设置

[00:37]
移除缓存组后，设置规则：
- 首先**指定规则适用于所有块 `chunks`**（包括初始和异步块）；
- 接着**指定块的最大尺寸 `maxSize`**，指示打包器将超过最大尺寸的块（chunk）拆分为更小的部分。它是*提示性参数（产物bundle可能会略大于maxSize）*，*默认值为零*（无最大尺寸限制），*主要用于 http/2、长期缓存*（可增加请求次数优化性能）、*减小文件大小加快重新构建速度*；
- 同时也**指定最小尺寸 `minSize`**，最大和最小尺寸均*以字节为单位*。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/da754727a0e3d760dcaf09a685bcba43_MD5.jpeg]]

## 规则应用后的打包结果

[01:53]
运行包分析器发现，**Webpack 自行识别并将 jquery 和 bootstrap 提取到单独包中，还根据规则提取了几个额外包**，*但存在包名不可读的缺点*。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/d7e9645e47a07a2dd5883ec66614bfa2_MD5.jpeg]]

## 解决包名不可读问题（参考上图）

[02:34]
*通过取文件绝对路径并转换为数组，按斜杠字符分割后取数组最后一个元素的方法*，基于包包含的模块生成易读包名，改善了包命名情况，如 Bootstrap 和 jquery 有易读名称，由多个库组成的包名称含'main'相关组合。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/5dda58b34b6af6653458847c06a6ceb7_MD5.jpeg]]


![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/6a554cc8fbbc461169d99075aeb4a15d_MD5.jpeg]]

## 总结本视频核心内容

[04:09]
Webpack 可自行判断哪些模块应生成单独捆绑包，用户只需指定一组规则，Webpack 就能依据规则做出代码分割决策。
