How To Analyze Bundles Generated By Webpack

视频讲述了在进行 Webpack 代码拆分前，如何*使用 webpack 包分析器工具分析当前生成的生产包*，介绍了*工具安装配置、报告查看及单包存在的缺点，为后续代码拆分做铺垫*，具体如下：

## 为什么使用分析工具？

[00:00]
本节核心是**先分析当前 Webpack 生成的包，再学习代码拆分**；
**当前仅生成一个包含大量内容的包，且单看生成代码难以理解包内组成，需借助工具分析**。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/0e5136111d3fca4265db3014eaca1f7d_MD5.jpeg]]

## 介绍 webpack 包分析器工具

[00:35]
该工具`webpack-bundle-analyzer`**能可视化 Webpack 输出文件大小并提供交互式表示，能帮助了解包的组成部分**，将在视频中使用该工具进行包分析。

## 安装包分析器并配置 Webpack 

[00:52]
需在终端安装工具，*基于生产配置创建单独的 Webpack 配置*，导入所需内容后导出专门用于分析的新配置，此配置仅添加包分析器插件这一改动。

## 详解包分析器插件关键选项

[02:19]
重点关注两个选项，
一是“`分析器模式 analyzerMode`”，有*服务器模式*（启动 HTTP 服务器显示报告）、*静态模式*（生成单个 HTML 文件报告）、*JSON 模式*（生成 JSON 文件报告），视频选用服务器模式；
二是“`打开分析器 openAnalyzer`”，可指示 Webpack *在默认浏览器自动打开报告*。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/48b4118bbf102447841b4aeeb066909c_MD5.jpeg]]


## 在 package.json 添加运行脚本

[03:11]
新增运行 Webpack 包分析器的脚本，指定生产模式，因需了解生产包统计信息以做出优化决策；
视频倾向*单独编写该脚本，避免每次运行生产构建都查看统计信息*。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/591b1cdb8101cae70ca2e8d5ebcfafde_MD5.jpeg]]

## 运行脚本并解读生产包报告

[04:11]
运行脚本后生成的报告页面中，**不同大小矩形框代表不同模块（小框为小模块，大框为大模块）**，可看到*代表 jquery（应用中最大库）和其他内容的大方框及数十个小模块方框*，
**且所有方框颜色大致相同，表明内容都属于一个 JavaScript 包**。

![[_posts/engineering/1.打包工具（Module Bundler）/webpack/教程/Webpack 5 Optimizing For Production/08. Applying Code Splitting and Lazy Loading/media/257a241abdf7b2b5140e5b9301a184bb_MD5.jpeg]]

## 单包存在的缺点

[05:16]
一是**所有代码在一个文件中，文件可能过大**，*且首屏无需一次性加载所有代码*；
二是**影响浏览器缓存**，*应用依赖的库很少更新，与代码捆绑后无法单独缓存，每次修改代码部署都会导致浏览器缓存失效*。

## 解决单包缺点的方向

[06:27]
单包的缺点*可通过 Webpack 原生提供的代码拆分功能缓解*，后续视频将学习如何拆分代码为多个包及不同的代码拆分策略。
