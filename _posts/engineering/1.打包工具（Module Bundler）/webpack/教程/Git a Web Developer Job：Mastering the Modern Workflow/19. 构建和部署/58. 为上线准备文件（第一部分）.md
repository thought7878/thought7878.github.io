Preparing Our Files for Go Live (Part 1)


视频讲述了*如何为网站上线准备文件，包括区分开发与生产环境文件、配置Webpack构建流程以及测试相关脚本等*内容，具体如下：

- **说明网站上线前的文件准备需求**：当前网站工作流仅适用于开发者（如`app`文件夹为源代码目录），但无法直接交付给Web主机供公众访问，因Webpack配置下CSS和JavaScript仅存储在内存中，通过`npm run dev`启动的本地服务器（`localhost:3000`）才能访问，需创建优化后的公众可用版本。
- **介绍开发与生产环境文件夹区分**：保留`app`文件夹作为开发者源代码目录，同时让Webpack自动生成`dist`（distribution缩写）文件夹，该文件夹将存储可交付给Web主机、供公众访问的网站文件，创建此副本的过程称为“构建流程（build process）”，且Webpack是实现该流程的优质工具。
- **处理Git分支管理**：先将“lazy loading”分支合并到`master`分支，执行`git status`查看变更，通过`git add`将变更加入暂存区，`git commit -m "completed lazy loading of images"`提交，再用`git checkout master`切换到`master`分支，执行`git merge lazy-loading`完成合并；之后创建并切换到“build-process”分支（`git checkout -b build-process`），用于配置构建流程。
- **配置npm的build脚本**：在`package.json`的“scripts”区域，新增“build”脚本，内容为`"build": "webpack"`（注意脚本间的逗号分隔）；`npm run dev`为持续运行的开发任务（启动Webpack Dev Server），`npm run build`为单次运行任务，用于生成公众可用的网站副本。
- **Webpack配置文件的环境区分设置**：在`webpack.config.js`顶部定义`currentTask`变量（通过`process`获取当前执行的npm脚本名称，值为“dev”或“build”）；创建`config`空对象存储配置，通过`if`语句分别为“dev”和“build”环境自定义配置，将原配置暂存为参考变量（后续可删除），最终通过`module.exports = config`导出配置。
- **配置Webpack的共享与环境专属项**：共享配置项为入口文件（始终指向`main app.js`），在`config`对象中直接设置；环境专属项方面，“dev”环境配置`output`（输出到`app`文件夹）和`devServer`相关参数，`mode`设为“development”；“build”环境配置`output`（输出到`dist`文件夹），`mode`设为“production”；暂将`module`配置作为共享项，复制到`config`对象中。
- **测试npm脚本功能**：测试`npm run dev`，确认Webpack Dev Server正常启动，网站可在`localhost:3000`访问，且修改`main app.js`（如添加`alert`）能实时生效；测试`npm run build`，确认项目目录下自动生成`dist`文件夹，内含打包后的JS文件（包含CSS和JS，以及按需加载的模态框JS文件）。
- **说明后续需完成的工作**：当前`dist`文件夹仅含部分文件，后续需配置Webpack以实现复制HTML文件、将CSS从JS中分离为独立文件、复制图片资源到`dist`文件夹等功能，完成后即可将网站文件交付给Web主机供公众访问。