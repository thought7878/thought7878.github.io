Vite 是一款快速的前端构建工具，它通过利用原生 ESM（ES Modules，即 ES6 模块系统）和按需编译的特性，显著提升了开发和构建效率，以下为你详细介绍这两个特性：

### 利用原生 ESM

#### 概念

原生 ESM 是 JavaScript 从 ES6（ES2015）开始引入的官方模块系统，允许开发者使用 `import` 和 `export` 语句在不同的 JavaScript 文件间导入和导出模块。**Vite 借助浏览器对原生 ESM 的支持，无需像传统打包工具（如 Webpack）那样*在开发阶段对所有模块进行打包*，而是让浏览器直接处理模块的加载**。

#### 工作原理

1. **服务器启动**：当启动 Vite 开发服务器时，它会启动一个本地服务器，但不会对项目中的所有模块进行打包。
2. **浏览器请求**：浏览器加载入口 HTML 文件后，会根据 HTML 中 `<script type="module">` 标签的引用，以 ESM 的方式向服务器请求各个 JavaScript 模块文件。
3. **模块处理**：Vite 服务器接收到请求后，会对模块进行简单的转换（如将 Vue SFC 拆分成不同部分），然后直接返回给浏览器，让浏览器自行解析和加载这些模块。

#### 优势

- **快速冷启动**：由于无需对整个项目进行打包，Vite 的冷启动时间极短，尤其是在大型项目中，优势更为明显。
- **简单高效**：减少了构建过程中的复杂操作，开发服务器可以快速响应浏览器的请求。

### 按需编译

#### 概念

按需编译指的是 Vite 只有在浏览器请求某个模块时，才会对该模块进行编译处理，而不是在启动时就对所有模块进行编译。

#### 工作原理

1. **请求触发**：当浏览器请求一个模块时，Vite 会根据该模块的类型（如 JavaScript、CSS、Vue 组件等），使用相应的插件和加载器对其进行编译。
2. **即时编译**：Vite 会即时对模块进行转换和处理，例如将 TypeScript 编译为 JavaScript，将 Sass 编译为 CSS 等。
3. **缓存机制**：Vite 会对编译结果进行缓存，当同一模块再次被请求时，如果内容没有变化，会直接使用缓存结果，避免重复编译，进一步提高编译效率。

#### 优势

- **节省资源**：避免了不必要的编译工作，减少了 CPU 和内存的消耗。
- **快速更新**：在开发过程中，当修改一个模块时，Vite 只需重新编译该模块，然后通过热更新（HMR）将更新后的模块推送给浏览器，无需重新编译整个项目，实现快速的代码更新和页面刷新。
