

通过查看 `src/DayPicker.tsx` 和 `src/useDayPicker.ts` 源码，可明确 `react-day-picker` 组件的初始化流程如下：

### 1. Props 预处理（时区转换）
在组件入口 `DayPicker` 函数中，首先处理 `timeZone` 相关配置：将 `today`、`month`、`selected` 等日期类 Props 转换为 `TZDate` 类型（依赖 `@date-fns/tz`），确保不同时区下的日期一致性（<mcfile name="DayPicker.tsx" path="/Users/ll/Desktop/learn-notes/frontend/react/3rd/react-day-picker/src/DayPicker.tsx"></mcfile>）。

### 2. 基础配置初始化
通过 `useMemo` 钩子初始化以下核心配置（仅执行一次，性能优化）：
- **日期工具库**：创建 `DateLib` 实例，集成 `locale`（本地化）、`weekStartsOn`（周起始日）等配置，负责日期计算（如月份切换、星期生成）。
- **自定义组件**：合并用户传入的 `components` 和默认组件（如 `Day`、`Month`），支持自定义 UI。
- **格式化工具**：合并用户 `formatters` 和默认格式化函数（如 `formatCaption` 格式化标题）。
- **标签文案**：合并用户 `labels` 和默认文案（如 `labelPrevious` 控制“上月”按钮文本）。
- **类名配置**：合并用户 `classNames` 和默认类名（如 `day` 对应日期格子的 CSS 类）。

### 3. 日历状态初始化
调用 `useCalendar` 钩子，基于 Props（如 `month`、`numberOfMonths`）和 `dateLib` 计算日历核心状态：
- `days`：当前显示的所有日期（含“外部日期”）。
- `months`：当前显示的月份数组（支持多月份视图）。
- `previousMonth`/`nextMonth`：上月/下月的日期对象（用于导航）。
- `goToMonth`：切换月份的方法（触发 `onMonthChange` 回调）。

### 4. 选择逻辑初始化
通过 `useSelection` 钩子管理日期选择状态：
- `selected`：当前选中的日期（支持单选、多选、范围选）。
- `select`：选择日期的方法（触发 `onSelect` 回调）。
- `isSelected`：判断日期是否被选中的函数。

### 5. 焦点管理初始化
调用 `useFocus` 钩子处理键盘导航和焦点状态：
- `focused`：当前聚焦的日期。
- `moveFocus`：按方向键移动焦点的方法（支持上下左右导航）。
- `blur`：移除焦点的方法（触发 `onDayBlur` 回调）。

### 6. 上下文提供状态
通过 `dayPickerContext` 上下文（<mcfile name="useDayPicker.ts" path="/Users/ll/Desktop/learn-notes/frontend/react/3rd/react-day-picker/src/useDayPicker.ts"></mcfile>），将上述状态（如 `months`、`select`、`getModifiers`）传递给子组件（如 `Day`、`Month`），确保内部组件共享统一状态。

### 总结
组件初始化核心是通过 **Props 预处理 → 配置初始化 → 状态计算 → 上下文共享** 的流程，实现可定制、多模式（单选/多选/范围选）、本地化的日期选择功能。